<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENEM AI - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden;
        }
        :root {
            --cor-primaria: #7F00FF;
            --cor-secundaria: #00C3FF;
            --cor-destaque: #FF61A6;
            --cor-fundo: #1A1A2E;
            --cor-branco: #FFFFFF;
            --cor-texto: #f8f8fa;
            --cor-editor-bg: rgba(255,255,255,0.04);
            --cor-toolbar-bg: rgba(40, 20, 60, 0.85);
            --cor-footer: #bdbdbd;
            --fonte-titulo: 'Montserrat', sans-serif;
            --fonte-texto: 'Poppins', sans-serif;
            --sidebar: #35355a;
            --sidebar-foreground: #f8f8fa;
            --sidebar-primary: #6c4cff;
            --sidebar-primary-foreground: #f8f8fa;
            --sidebar-accent: #444444;
            --sidebar-accent-foreground: #f8f8fa;
            --sidebar-border: rgba(255,255,255,0.1);
            --sidebar-btn-bg: var(--cor-primaria);
            --sidebar-btn-hover: var(--cor-secundaria);
            --sidebar-btn-active: var(--cor-destaque);
            --sidebar-btn-border: #fff;
            --sidebar-btn-shadow: var(--cor-primaria);
        }
        html, body {
            height: 100%;
            overflow-x: hidden;
        }
        /* Removido body.light-mode e alternância de tema */
        body {
            font-family: var(--fonte-texto);
            background: linear-gradient(135deg, var(--cor-primaria) 0%, var(--cor-fundo) 100%);
            min-height: 100vh;
            color: var(--cor-texto);
            margin-left: 60px;
            transition: margin-left 0.3s cubic-bezier(0.4,0,0.2,1);
            height: 100vh;
            overflow-x: hidden;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--fonte-titulo);
        }
        /* Cards e botões modernos */
        .rounded-xl, .rounded-lg, .rounded-full {
            border-radius: 1.5rem !important;
        }
        .glass-card, .shadow-2xl, .shadow-lg {
            box-shadow: 0 8px 32px rgba(127,0,255,0.10), 0 1.5px 4px rgba(0,0,0,0.04) !important;
        }
        .btn-primary, .btn-secondary, .btn-success, .btn-warning, .bg-purple-600, .bg-purple-700 {
            border-radius: 9999px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(127,0,255,0.10);
            transition: background 0.3s, color 0.3s, box-shadow 0.3s;
        }
        .btn-primary:hover, .btn-secondary:hover, .btn-success:hover, .btn-warning:hover, .bg-purple-600:hover, .bg-purple-700:hover {
            background: var(--cor-secundaria) !important;
            color: var(--cor-branco) !important;
            box-shadow: 0 4px 16px rgba(127,0,255,0.18);
        }
        /* Microinterações e acessibilidade */
        a, button, input {
            outline: none;
            transition: box-shadow 0.2s, border 0.2s, background 0.2s, color 0.2s;
        }
        a:focus-visible, button:focus-visible, input:focus-visible {
            box-shadow: 0 0 0 3px var(--cor-secundaria), 0 0 0 6px var(--cor-branco);
            border: 2px solid var(--cor-secundaria);
        }
        /* Contraste aprimorado */
        .text-gray-900, .font-bold, h1, h2, h3, h4, h5, h6 {
            color: #fff !important;
            text-shadow: 0 2px 8px rgba(0,0,0,0.10);
        }
        .text-gray-600, .text-gray-500, .text-gray-400, .text-gray-300 {
            color: #e0e0e0 !important;
        }
        /* Responsividade */
        @media (max-width: 1024px) {
            .rounded-xl, .rounded-lg { border-radius: 1rem !important; }
        }
        @media (max-width: 768px) {
            .rounded-xl, .rounded-lg { border-radius: 0.7rem !important; }
        }
            @media (max-width: 900px) {
        body {
            margin-left: 60px;
        }
        
        .editor-contenteditable {
            font-size: 1.1rem;
            line-height: 1.6;
            min-height: 350px;
            max-height: 500px;
        }
        
        /* Ajuste para dispositivos móveis */
        .editor-wrapper {
            padding: 0 0.5rem;
        }
        
        /* Ajuste da área de edição */
        .editor-area {
            min-height: 300px;
        }
    }
        /* Animação fade-in para as seções */
        .fade-section {
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s cubic-bezier(0.4,0,0.2,1), transform 0.8s cubic-bezier(0.4,0,0.2,1);
        }
        .fade-section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Shapes decorativos SVG */
        .shape-bg {
            position: absolute;
            z-index: 0;
            pointer-events: none;
        }
        .shape1 { top: -60px; left: -60px; width: 180px; opacity: 0.18; }
        .shape2 { bottom: -80px; right: -80px; width: 220px; opacity: 0.13; }
        .shape3 { top: 40%; left: 80%; width: 120px; opacity: 0.10; }
        /* Sidebar moderna */
        .sidebar {
            position: fixed;
            top: 0; left: 0; bottom: 0;
            width: 60px;
            background: var(--sidebar);
            color: var(--sidebar-foreground);
            border-right: 1px solid var(--sidebar-border);
            display: flex;
            flex-direction: column;
            z-index: 100;
            transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
        }
        .sidebar:hover, .sidebar:focus-within {
            width: 220px;
        }
        .sidebar-site-logo {
            width: 100%;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            flex-direction: row;
            gap: 0.7em;
            margin-bottom: 0.5em;
            position: relative;
            transition: justify-content 0.4s;
        }
        .sidebar-site-logo i {
            font-size: 2.2em;
            color: #fff;
            transition: font-size 0.4s;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sidebar-logo-text {
            color: #fff;
            font-family: var(--fonte-titulo);
            font-size: 1.3em;
            font-weight: bold;
            margin-left: 0.3em;
            white-space: nowrap;
            letter-spacing: 1px;
            opacity: 0;
            max-width: 0;
            width: 0;
            padding: 0;
            overflow: hidden;
            transition: opacity 0.4s, max-width 0.4s, width 0.4s, margin 0.4s, padding 0.4s;
            display: inline-block;
            vertical-align: middle;
        }
        .sidebar:not(:hover):not(:focus-within) .sidebar-site-logo {
            justify-content: center;
        }
        .sidebar:not(:hover):not(:focus-within) .sidebar-logo-text {
            opacity: 0;
            max-width: 0;
            width: 0;
            padding: 0;
            margin: 0;
        }
        .sidebar:hover .sidebar-site-logo,
        .sidebar:focus-within .sidebar-site-logo {
            justify-content: flex-start;
        }
        .sidebar:hover .sidebar-logo-text,
        .sidebar:focus-within .sidebar-logo-text {
            opacity: 1;
            max-width: 90px;
            width: auto;
            margin-left: 0.3em;
            padding: 0;
        }
        .sidebar-header {
            max-height: 70px;
            min-height: 70px;
            border-bottom: 1px solid var(--sidebar-border);
        }
        .sidebar-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.7rem;
            padding: 1.2rem 1.3rem 0.5rem 0.5rem;
            align-items: flex-start;
        }
        .sidebar-btn, .sidebar-label {
            text-decoration: none !important;
        }
        .sidebar-btn {
            width: 100%;
            background: none;
            border: none;
            outline: none;
            margin: 0;
            padding: 0.25em 0.3em;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            border-radius: 7px;
            box-shadow: 0 1px 0 1px var(--sidebar-btn-shadow);
            border: 1.2px solid var(--sidebar-btn-border);
            font-size: 10px;
            color: #fff;
            font-weight: 600;
            background-color: var(--sidebar-btn-bg);
            overflow: hidden;
            min-height: 32px;
            height: 32px;
            transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
        }
        .sidebar-btn .circle-icon {
            width: 18px;
            height: 18px;
            font-size: 0.9em;
            color: #fff !important;
            background: transparent !important;
            box-shadow: none !important;
            transition: color 0.2s, margin 0.2s, left 0.2s;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sidebar-btn .sidebar-label {
            display: none;
            margin-left: 0.5em;
            font-size: 0.90em;
            color: #fff;
            font-weight: 500;
            z-index: 2;
        }
        .sidebar:hover .sidebar-btn .sidebar-label,
        .sidebar:focus-within .sidebar-btn .sidebar-label {
            display: inline;
        }
        /* Centralizar ícone quando sidebar retraída */
        .sidebar:not(:hover):not(:focus-within) .sidebar-btn {
            justify-content: center;
        }
        .sidebar:not(:hover):not(:focus-within) .sidebar-btn .circle-icon {
            margin: 0;
        }
        .sidebar:not(:hover):not(:focus-within) .sidebar-btn .sidebar-label {
            display: none !important;
        }
        .sidebar-btn:before {
            content: "";
            position: absolute;
            width: 70px;
            height: 120%;
            background-color: var(--sidebar-btn-active);
            top: 50%;
            left: 0;
            transform: skewX(30deg) translate(-150%, -50%);
            transition: all 0.5s;
            z-index: 1;
        }
        .sidebar-btn:hover, .sidebar-btn:focus {
            background-color: var(--sidebar-btn-hover);
            color: #fff;
            box-shadow: 0 2px 0 2px var(--cor-secundaria);
        }
        .sidebar-btn:hover:before, .sidebar-btn:focus:before {
            transform: skewX(30deg) translate(150%, -50%);
            transition-delay: 0.1s;
        }
        .sidebar-btn:active {
            transform: scale(0.95);
        }
        .sidebar-user {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 1.2rem 1rem 1.2rem 1.1em;
            border-top: 1px solid var(--sidebar-border);
            transition: opacity 0.3s;
            margin-top: auto;
        }
        .sidebar-avatar {
            max-width: 32px;
            min-width: 32px;
            min-height: 32px;
            max-height: 32px;
            border-radius: 50%;
            border: 2px solid var(--sidebar-primary);
            background: #fff;
            color: var(--sidebar-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1em;
        }
        .sidebar-username {
            font-size: 1em;
            font-weight: 500;
            color: var(--sidebar-foreground);
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .sidebar:hover .sidebar-username, .sidebar:focus-within .sidebar-username {
            opacity: 1;
        }
        @media (max-width: 900px) {
            .sidebar {
                width: 60px !important;
            }
            .sidebar:hover, .sidebar:focus-within {
                width: 180px !important;
            }
        }
        
        /* Sidebar moderna */
        .sidebar-footer {
            padding: 1rem;
            border-top: 1px solid var(--sidebar-border);
            text-align: right;
        }
        #sidebar-toggle {
            background: none;
            border: none;
            color: var(--sidebar-foreground);
            font-size: 1.3rem;
            cursor: pointer;
        }
        /* Sistema de Anotações Redesenhado */
        .notes-main-container {
          max-width: 2000px;
          min-width: 2000px;
          margin: 40px auto 0 auto;
          background: rgba(40, 20, 60, 0.85);
          border-radius: 1.5rem;
          box-shadow: 0 8px 32px rgba(127,0,255,0.10);
          padding: 2.5rem 2rem 2rem 2rem;
          min-height: 600px;
          display: flex;
          flex-direction: column;
          gap: 2rem;
        }
        .notes-tabs {
          display: flex;
          gap: 1.2rem;
          margin-bottom: 1.5rem;
          border-bottom: 2px solid #3b2a5a;
          padding-bottom: 0.5rem;
        }
        .notes-tab {
          background: none;
          border: none;
          color: #fff;
          font-family: var(--fonte-titulo);
          font-size: 1.1rem;
          font-weight: 600;
          padding: 0.7em 1.5em;
          border-radius: 1.5em 1.5em 0 0;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 0.7em;
          transition: background 0.2s, color 0.2s;
          position: relative;
        }
        .notes-tab.active, .notes-tab:hover {
          background: var(--cor-primaria);
          color: #fff;
          box-shadow: 0 2px 8px rgba(127,0,255,0.10);
        }
        .notes-content {
          min-height: 400px;
          width: 100%;
        }
        /* Cards de notas */
        .note-card {
          background: rgba(60, 30, 90, 0.92);
          border-radius: 1.2rem;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 1.2rem;
          margin-bottom: 1rem;
          transition: all 0.2s ease;
          border: 1px solid rgba(255,255,255,0.05);
        }
        .note-card:hover {
          background: rgba(70, 40, 100, 0.95);
          transform: translateY(-2px);
          box-shadow: 0 6px 28px rgba(127,0,255,0.15);
        }
        .note-card.selected {
          border: 2px solid var(--cor-secundaria);
          box-shadow: 0 0 0 4px rgba(0,195,255,0.08);
        }
        .note-title {
          font-size: 1.1rem;
          font-weight: 700;
          color: #fff;
          margin-bottom: 0.3em;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .note-preview {
          color: #e0e0e0;
          font-size: 0.95rem;
          margin-bottom: 0.5em;
          line-height: 1.4;
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          overflow: hidden;
        }
        .note-tags {
          display: flex;
          gap: 0.5em;
          flex-wrap: wrap;
          margin-bottom: 0.5em;
        }
        .note-tag {
          background: #7F00FF;
          color: #fff;
          border-radius: 1em;
          padding: 0.2em 0.8em;
          font-size: 0.9em;
          font-weight: 500;
        }
        .note-actions {
          display: flex;
          gap: 1em;
          margin-top: 0.5em;
        }
        .note-action-btn {
          background: var(--cor-primaria);
          color: #fff;
          border: none;
          border-radius: 1em;
          padding: 0.5em 1.2em;
          font-size: 1em;
          font-weight: 600;
          display: flex;
          align-items: center;
          gap: 0.5em;
          cursor: pointer;
          transition: background 0.2s;
        }
        .note-action-btn:hover {
          background: var(--cor-secundaria);
        }
        /* Editor de nota */
        .note-editor-container {
          background: rgba(60, 30, 90, 0.97);
          border-radius: 1.2rem;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 2rem 1.5rem;
          margin-bottom: 1.5rem;
          display: flex;
          flex-direction: column;
          gap: 1.2rem;
        }
        .note-editor-toolbar {
          display: flex;
          gap: 1.2em;
          margin-bottom: 1em;
          flex-wrap: wrap;
          background: rgba(40, 20, 60, 0.7);
          border-radius: 0.8em;
          padding: 0.7em 1em;
          position: sticky;
          top: 0;
          z-index: 10;
        }
        .note-toolbar-btn {
          background: none;
          border: none;
          color: #fff;
          font-size: 1.2em;
          padding: 0.4em 0.7em;
          border-radius: 0.7em;
          cursor: pointer;
          transition: background 0.2s, color 0.2s;
        }
        .note-toolbar-btn:hover, .note-toolbar-btn.active {
          background: var(--cor-secundaria);
          color: #fff;
        }
        .note-editor-title {
          font-size: 1.3em;
          font-weight: 700;
          color: #fff;
          background: transparent;
          border: none;
          outline: none;
          width: 100%;
          margin-bottom: 0.5em;
          padding: 0.2em 0.5em;
          border-radius: 0.5em;
        }
        .note-editor-content {
          height: 600px;
          max-height: 600px;
          min-height: 600px;
          overflow-y: auto;
          background: rgba(40, 20, 60, 0.85);
          border-radius: 1em;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 1.5em;
          outline: none;
          font-size: 1.1em;
          color: #fff;
          transition: box-shadow 0.2s;
          word-break: break-word;
          white-space: pre-wrap;
        }
        .note-editor-tags {
          display: flex;
          gap: 0.5em;
          flex-wrap: wrap;
          margin-bottom: 0.5em;
        }
        .note-editor-tag {
          background: #7F00FF;
          color: #fff;
          border-radius: 1em;
          padding: 0.2em 0.8em;
          font-size: 0.95em;
          font-weight: 500;
          margin-right: 0.3em;
        }
        .note-tag {
          background: #7F00FF;
          color: #fff;
          border-radius: 1em;
          padding: 0.2em 0.8em;
          font-size: 0.85em;
          font-weight: 500;
        }
        .note-add-tag-btn {
          background: none;
          border: 1.5px dashed var(--cor-secundaria);
          color: var(--cor-secundaria);
          border-radius: 1em;
          padding: 0.2em 0.8em;
          font-size: 0.95em;
          font-weight: 500;
          cursor: pointer;
          margin-left: 0.3em;
          transition: background 0.2s, color 0.2s;
        }
        .note-add-tag-btn:hover {
          background: var(--cor-secundaria);
          color: #fff;
        }
        /* Responsividade */
        @media (max-width: 900px) {
          .notes-main-container {
            padding: 1.2rem 0.5rem 1rem 0.5rem;
          }
          .note-editor-container {
            padding: 1.2rem 0.7rem;
          }
          .note-card {
            padding: 1.2rem 0.7rem;
          }
          .notes-tabs {
            gap: 0.5rem;
          }
        }
        .font-select {
          background: #2d2d3a !important;
          color: #e0e0e0 !important;
          border: none;
        }
        .font-select option {
          background: #23234a;
          color: #e0e0e0;
        }
        .note-editor-area {
          display: flex;
          justify-content: center;
          align-items: flex-start;
          width: 100%;
          background: none;
          box-shadow: none;
          border-radius: 0;
          padding: 0;
          margin: 0;
        }
        .note-editor-wrapper {
          max-width: 700px;
          width: 100%;
          margin: 0 auto;
          display: flex;
          flex-direction: column;
          flex: 1;
        }
        .note-editor-content {
          height: 600px;
          max-height: 600px;
          min-height: 600px;
          overflow-y: auto;
          background: rgba(40, 20, 60, 0.85);
          border-radius: 1em;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 1.5em;
          outline: none;
          font-size: 1.1em;
          color: #fff;
          transition: box-shadow 0.2s;
          word-break: break-word;
          white-space: pre-wrap;
        }
        @media (max-width: 900px) {
          .note-editor-area {
            padding-left: 0;
          }
          .note-editor-wrapper {
            max-width: 100vw;
            min-width: 0;
          }
        }
        .markdown-toolbar {
          position: fixed;
          left: 60px;
          top: 50%;
          transform: translateY(-50%);
          display: flex;
          flex-direction: column;
          gap: 0.7em;
          background: rgba(40, 20, 60, 0.95);
          border-radius: 1em;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 1em 0.5em;
          z-index: 101;
        }
        @media (max-width: 900px) {
          .markdown-toolbar { display: none; }
        }
        .markdown-toolbar-btn {
          background: none;
          border: none;
          color: #e0e0e0;
          font-size: 1.3em;
          border-radius: 0.5em;
          padding: 0.4em 0.6em;
          cursor: pointer;
          transition: background 0.2s, color 0.2s;
          position: relative;
        }
        .markdown-toolbar-btn:hover, .markdown-toolbar-btn:focus {
          background: var(--cor-secundaria);
          color: #fff;
        }
        .markdown-toolbar-btn:active {
          background: var(--cor-primaria);
          color: #fff;
        }
        .markdown-toolbar-btn[title]::after {
          content: attr(title);
          position: absolute;
          left: 110%;
          top: 50%;
          transform: translateY(-50%);
          background: #23234a;
          color: #fff;
          font-size: 0.85em;
          padding: 0.3em 0.7em;
          border-radius: 0.5em;
          white-space: nowrap;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.2s;
          z-index: 20;
        }
        .markdown-toolbar-btn:hover[title]::after, .markdown-toolbar-btn:focus[title]::after {
          opacity: 1;
        }
        .note-editor-area { position: relative; }
        .markdown-toolbar-top {
          display: flex;
          flex-wrap: wrap;
          gap: 0.7em;
          background: rgba(40, 20, 60, 0.95);
          border-radius: 1em 1em 0 0;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 1em 1.5em 0.5em 1.5em;
          align-items: center;
          margin-bottom: 0.5em;
          justify-content: center;
        }
        .markdown-toolbar-btn {
          background: none;
          border: none;
          color: #e0e0e0;
          font-size: 1.1em;
          border-radius: 0.5em;
          padding: 0.4em 0.8em;
          cursor: pointer;
          transition: background 0.2s, color 0.2s;
          display: flex;
          align-items: center;
          gap: 0.4em;
          font-family: inherit;
          font-weight: 500;
        }
        .markdown-toolbar-btn:hover, .markdown-toolbar-btn:focus {
          background: var(--cor-secundaria);
          color: #fff;
        }
        .markdown-toolbar-btn:active {
          background: var(--cor-primaria);
          color: #fff;
        }
        @media (max-width: 700px) {
          .markdown-toolbar-top { flex-wrap: wrap; padding: 0.7em 0.5em 0.3em 0.5em; }
          .markdown-toolbar-btn { font-size: 0.95em; padding: 0.3em 0.5em; }
        }
        .toolbar-container {
          width: 100%;
          max-width: 900px;
          margin: 0 auto 1em auto;
          display: flex;
          justify-content: center;
          position: relative;
          z-index: 10;
        }
        .note-toolbar-top {
          display: flex;
          flex-wrap: wrap;
          gap: 1em;
          background: linear-gradient(90deg, #7F00FF 0%, #00C3FF 100%);
          border-radius: 1em 1em 0 0;
          box-shadow: 0 4px 24px rgba(127,0,255,0.10);
          padding: 1em 2em 0.7em 2em;
          align-items: center;
          justify-content: center;
          width: 100%;
        }
        @media (max-width: 900px) {
          .toolbar-container {
            max-width: 100vw;
            padding: 0 0.2em;
          }
          .note-toolbar-top {
            flex-wrap: wrap;
            padding: 0.7em 0.2em 0.3em 0.2em;
            gap: 0.5em;
          }
        }
        @media (max-width: 700px) {
          .toolbar-container {
            min-width: 100px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            margin: 0 auto;
            z-index: 100;
            transition: top 0.3s;
          }
        }
        .editor-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 80vh;
            padding: 48px 0 32px 0;
        }
        .editor-area {
            background: var(--cor-editor-bg);
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(127,0,255,0.10);
            max-width: 700px;
            width: 100%;
            min-height: 340px;
            padding: 32px 32px 32px 32px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            font-family: 'Inter', 'Poppins', 'Montserrat', Arial, sans-serif;
            color: var(--cor-texto);
        }
        .editor-textarea {
            width: 100%;
            min-height: 220px;
            border: none;
            outline: none;
            background: transparent;
            color: var(--cor-texto);
            font-size: 1.18rem;
            font-weight: 400;
            letter-spacing: 0.01em;
            line-height: 1.7;
            resize: vertical;
            padding: 0;
            margin: 0;
        }
        .editor-textarea::placeholder {
            color: #bdbdbd;
            font-style: italic;
            font-size: 1.08rem;
        }
        @media (max-width: 900px) {
            .editor-area {
                max-width: 98vw;
                padding: 18px 6vw;
            }
        }
        .editor-title {
            font-family: 'Montserrat', 'Inter', Arial, sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 1.2rem;
            letter-spacing: 0.01em;
        }
        .editor-toolbar {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            background: var(--cor-toolbar-bg);
            border-radius: 12px 12px 0 0;
            padding: 0.7em 1.5em 0.7em 1.5em;
            margin: 0 auto 0.5em auto;
            max-width: 700px;
            box-shadow: 0 2px 8px rgba(127,0,255,0.10);
        }
        .toolbar-btn {
            background: none;
            border: none;
            color: var(--cor-texto);
            font-size: 1.18rem;
            padding: 0.4em 0.7em;
            border-radius: 0.7em;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
            display: flex;
            align-items: center;
            gap: 0.4em;
        }
        .toolbar-btn:hover, .toolbar-btn:focus {
            background: var(--cor-secundaria);
            color: #fff;
        }
        .toolbar-btn:active {
            background: var(--cor-primaria);
            color: #fff;
        }
        .toolbar-dropdown .toolbar-btn {
            font-size: 1.18rem;
            padding: 0.4em 0.7em;
        }
        .toolbar-dropdown .toolbar-btn:hover, .toolbar-dropdown .toolbar-btn:focus {
            background: var(--cor-secundaria);
            color: #fff;
        }
        .editor-contenteditable {
            width: 100%;
            min-height: 400px;
            max-height: 600px;
            border: none;
            outline: none;
            background: transparent;
            color: var(--cor-texto);
            font-size: 1.18rem;
            font-family: 'Inter', 'Poppins', 'Montserrat', Arial, sans-serif;
            line-height: 1.7;
            resize: none;
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            overflow-wrap: break-word;
            word-wrap: break-word;
            word-break: break-word;
            white-space: pre-wrap;
            overflow-y: auto;
        }
        .editor-contenteditable:empty:before {
            content: attr(data-placeholder);
            color: #bdbdbd;
            font-style: italic;
            pointer-events: none;
        }
        .toolbar-btn.active {
            background: var(--cor-primaria);
            color: #fff;
        }
        @media (max-width: 700px) {
            .editor-area {
                max-width: 98vw;
                padding: 12px 2vw;
                border-radius: 10px;
            }
            .editor-toolbar {
                max-width: 98vw;
                flex-wrap: wrap;
                padding: 0.5em 0.5em;
                gap: 0.7em;
            }
            .editor-footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5em;
                font-size: 0.95em;
            }
            .editor-contenteditable {
                font-size: 1rem;
                line-height: 1.6;
                min-height: 300px;
                max-height: 400px;
            }
        }
        @media (max-width: 768px) {
            body {
                margin-left: 60px;
                height: 100vh;
                overflow: hidden;
            }
            
            .editor-contenteditable {
                font-size: 1rem;
                line-height: 1.6;
                min-height: 300px;
                max-height: 500px;
            }
            
            /* Ajuste para dispositivos móveis */
            .editor-wrapper {
                padding: 0 0.5rem;
                height: calc(100vh - 100px);
            }
            
            /* Ajuste da área de edição */
            .editor-area {
                min-height: 300px;
                height: 100%;
            }
            
            /* Container para a área editável */
            .editor-content-container {
                height: 100%;
            }
        }
        .toolbar-btn:focus-visible {
            outline: 2px solid var(--cor-secundaria);
            outline-offset: 2px;
        }
        .editor-contenteditable:focus-visible {
            outline: 2px solid var(--cor-secundaria);
            outline-offset: 2px;
        }
        /* Remover botão de alternância de tema */
    </style>
    <script>
    // Sistema de abas intuitivo e dinâmico
    // ... Aqui virá o JS para alternar abas, criar, editar, filtrar e exibir notas ...
    </script>
</head>
<body>
    <!-- Sidebar moderna padronizada -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-site-logo">
            <img src="images/logo.png" alt="Logo EnemAI" class="sidebar-logo-img" style="height:48px;width:48px;min-width:48px;min-height:48px;max-width:48px;max-height:48px;margin:0 0.5em 0 0.5em;display:block;object-fit:cover;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,0.10);" />
            <span class="sidebar-logo-text">EnemAI</span>
        </div>
        <div class="sidebar-header"></div>
        <style>
            /* Exibe a logo sempre, mas oculta quando sidebar está retraída (não hover/focus) */
            .sidebar .sidebar-logo-img {
                height: 48px !important;
                width: 48px !important;
                min-width: 48px !important;
                min-height: 48px !important;
                max-width: 48px !important;
                max-height: 48px !important;
                margin: 0 0.5em 0 0.5em !important;
                display: block !important;
                object-fit: cover !important;
                border-radius: 50% !important;
                box-shadow: 0 2px 8px rgba(0,0,0,0.10);
                transition: opacity 0.3s ease;
                opacity: 1 !important;
            }
            .sidebar:not(:hover):not(:focus-within) .sidebar-logo-img {
                opacity: 0 !important;
            }
        </style>
        <nav class="sidebar-content">
            <a href="main-dashboard.html" class="sidebar-btn active">
                <div class="circle-icon active"><i class="fas fa-tachometer-alt"></i></div>
                <span class="sidebar-label">Dashboard</span>
            </a>
            <a href="ai-chat.html" class="sidebar-btn">
                <div class="circle-icon"><i class="fas fa-robot"></i></div>
                <span class="sidebar-label">Chat IA</span>
            </a>
            <a href="settings.html" class="sidebar-btn">
                <div class="circle-icon"><i class="fas fa-cog"></i></div>
                <span class="sidebar-label">Configurações</span>
            </a>
            <a href="community.html" class="sidebar-btn">
                <div class="circle-icon"><i class="fas fa-users"></i></div>
                <span class="sidebar-label">Comunidade</span>
            </a>
            <a href="dashboard.html" class="sidebar-btn" id="sidebar-new-note-btn">
                <div class="circle-icon"><i class="fas fa-plus"></i></div>
                <span class="sidebar-label">Nova Nota</span>
            </a>
        </nav>
        <div class="sidebar-user">
            <div class="sidebar-avatar" id="sidebar-avatar">US</div>
            <span class="sidebar-username" id="sidebar-username">Usuário</span>
        </div>
    </aside>
    <script>
    // Garante que o botão 'Nova Nota' sempre recarrega a página dashboard.html
    document.addEventListener('DOMContentLoaded', function() {
        var btn = document.getElementById('sidebar-new-note-btn');
        if(btn) {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'dashboard.html';
            });
        }
    });
    // Sidebar dinâmica: avatar e nome
    (function() {
        const sidebarAvatar = document.getElementById('sidebar-avatar');
        const sidebarUsername = document.getElementById('sidebar-username');
        function updateSidebarUser() {
            const user = JSON.parse(localStorage.getItem('enemai_user'));
            if (!user) return;
            sidebarUsername.textContent = user.name || 'Usuário';
            if (user.avatar) {
                sidebarAvatar.innerHTML = `<img src="${user.avatar}" alt="Avatar" style="width:100%;height:100%;border-radius:50%">`;
            } else {
                const initials = (user.name||'Usuário').split(' ').map(n=>n[0]).join('').toUpperCase().slice(0,2);
                sidebarAvatar.textContent = initials;
            }
        }
        updateSidebarUser();
    })();
    </script>

    <!-- Shapes SVG decorativos -->
    <svg class="shape-bg shape1" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="100" cy="100" rx="100" ry="100" fill="url(#paint0_radial)"/></svg>
    <svg class="shape-bg shape2" viewBox="0 0 220 220" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="110" cy="110" rx="110" ry="110" fill="url(#paint1_radial)"/></svg>
    <svg class="shape-bg shape3" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="60" cy="60" rx="60" ry="60" fill="url(#paint2_radial)"/></svg>
    <defs>
      <radialGradient id="paint0_radial" cx="0.5" cy="0.5" r="0.5" gradientUnits="objectBoundingBox">
        <stop stop-color="#7F00FF"/>
        <stop offset="1" stop-color="#00C3FF"/>
      </radialGradient>
      <radialGradient id="paint1_radial" cx="0.5" cy="0.5" r="0.5" gradientUnits="objectBoundingBox">
        <stop stop-color="#FF61A6"/>
        <stop offset="1" stop-color="#7F00FF"/>
      </radialGradient>
      <radialGradient id="paint2_radial" cx="0.5" cy="0.5" r="0.5" gradientUnits="objectBoundingBox">
        <stop stop-color="#00C3FF"/>
        <stop offset="1" stop-color="#FF61A6"/>
      </radialGradient>
    </defs>

    <!-- Área de Listagem e Busca de Notas -->
    <main class="editor-wrapper" id="main-dashboard-content" style="min-width: 0; height: calc(100vh - 100px); display: flex; flex-direction: column; flex: 1; overflow: hidden;">
        <div style="display: flex; gap: 2rem; max-width: 1200px; margin: 0 auto; padding: 0 1rem; min-width: 0; height: calc(100vh - 100px); flex: 1; overflow: hidden;">
            <!-- Lista de notas - coluna esquerda -->
            <div style="flex: 1; max-width: 400px; min-width: 0;">
                <div style="display:flex;justify-content:space-between;align-items:center;gap:1em;flex-wrap:wrap;margin-bottom: 1.5rem;">
                    <h2 style="font-family: var(--fonte-titulo); font-size: 1.5rem; color: #fff; margin: 0;">Minhas Anotações</h2>
                    <button id="btn-new-note" class="btn-primary" style="padding:0.6em 1.5em;">Nova Nota</button>
                </div>
                <div style="display:flex; gap:1em; margin-bottom: 1.5rem;">
                    <input id="search-notes" type="text" placeholder="Buscar notas..." style="flex:1;padding:0.6em 1em;border-radius:1em;border:none;background:#2d2d3a;color:#fff;font-size:1em;" />
                </div>
                <div id="notes-list" style="display:flex;flex-direction:column;gap:1em;max-height: calc(100vh - 200px); overflow-y: auto;"></div>
            </div>
            
            <!-- Editor - coluna direita -->
            <div style="flex: 2; display: flex; flex-direction: column; gap: 1rem; min-width: 0; height: 100%;">
                <!-- Toolbar do editor -->
                <nav class="editor-toolbar" aria-label="Barra de ferramentas do editor">
                    <button class="toolbar-btn" id="btn-bold" title="Negrito (Ctrl+B)" type="button" aria-label="Negrito (Ctrl+B)" tabindex="0"><i class="fas fa-bold"></i></button>
                    <button class="toolbar-btn" id="btn-italic" title="Itálico (Ctrl+I)" type="button" aria-label="Itálico (Ctrl+I)" tabindex="0"><i class="fas fa-italic"></i></button>
                    <button class="toolbar-btn" id="btn-underline" title="Sublinhado (Ctrl+U)" type="button" aria-label="Sublinhado (Ctrl+U)" tabindex="0"><i class="fas fa-underline"></i></button>
                    <button class="toolbar-btn" id="btn-heading" title="Cabeçalho" type="button" aria-label="Cabeçalho" tabindex="0"><i class="fas fa-heading"></i></button>
                    <button class="toolbar-btn" id="btn-list" title="Lista" type="button" aria-label="Lista" tabindex="0"><i class="fas fa-list-ul"></i></button>
                    <button class="toolbar-btn" id="btn-undo" title="Desfazer (Ctrl+Z)" type="button" aria-label="Desfazer (Ctrl+Z)" tabindex="0"><i class="fas fa-undo"></i></button>
                    <button class="toolbar-btn" id="btn-redo" title="Refazer (Ctrl+Y)" type="button" aria-label="Refazer (Ctrl+Y)" tabindex="0"><i class="fas fa-redo"></i></button>
                    <button class="toolbar-btn" id="btn-save" title="Salvar" type="button" aria-label="Salvar" tabindex="0"><i class="fas fa-save"></i></button>
                    <div class="toolbar-dropdown" style="position: relative; display: inline-block;">
                        <button class="toolbar-btn" id="btn-export" title="Exportar" type="button" aria-label="Exportar" tabindex="0"><i class="fas fa-download"></i></button>
                        <div id="export-dropdown" style="display: none; position: absolute; top: 100%; left: 0; background: rgba(40, 20, 60, 0.95); border-radius: 0.7em; padding: 0.5em; z-index: 100; min-width: 120px;">
                            <button class="toolbar-btn" id="btn-export-txt" style="display: block; width: 100%; text-align: left; margin: 0.2em 0; font-size: 0.9em;">TXT</button>
                            <button class="toolbar-btn" id="btn-export-md" style="display: block; width: 100%; text-align: left; margin: 0.2em 0; font-size: 0.9em;">Markdown</button>
                        </div>
                    </div>
                </nav>
                
                <!-- Área do editor -->
                <section class="editor-area" style="flex: 1; display: flex; flex-direction: column; min-height: 0; overflow: hidden; height: 100%;">
                    <input id="note-title" class="editor-title" placeholder="Título da nota" style="width:100%;margin-bottom:1em;background:rgba(40,20,60,0.15);border:none;color:#fff;padding:0.7em 1em;border-radius:0.7em;font-size:1.3em;font-weight: 600;" />
                    
                    <!-- Seção de tags -->
                    <div id="tags-section" style="margin-bottom: 1rem; display: none;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <span style="font-size: 0.9em; color: #e0e0e0;">Tags:</span>
                            <div id="note-tags" style="display: flex; gap: 0.5rem; flex-wrap: wrap; flex: 1;"></div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="text" id="new-tag-input" placeholder="Adicionar tag..." style="flex: 1; padding: 0.4em 0.8em; border-radius: 1em; border: none; background: rgba(40,20,60,0.3); color: #fff; font-size: 0.9em;" />
                            <button id="add-tag-btn" class="btn-primary" style="padding: 0.4em 1em; font-size: 0.9em;">Adicionar</button>
                        </div>
                    </div>
                    
                    <!-- Container para a área editável -->
                    <div class="editor-content-container" style="flex: 1; min-height: 0; display: flex; flex-direction: column; overflow: hidden; height: 100%;">
                        <div class="editor-contenteditable" contenteditable="true" data-placeholder="Comece a escrever sua anotação aqui...&#10;&#10;Dicas:&#10;• Use a barra de ferramentas para formatar o texto&#10;• Adicione tags para organizar melhor suas anotações&#10;• Separe tópicos com cabeçalhos para facilitar a leitura" spellcheck="true" id="editor-content" role="textbox" aria-label="Área de edição de texto" tabindex="0" style="flex: 1; min-height: 0; height: 100%;"></div>
                    </div>
                    
                    <footer class="editor-footer" style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px; font-size: 0.98em; gap: 1.5em; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);" aria-live="polite">
                        <div style="display: flex; gap: 1.5em;">
                            <span id="word-count">0 palavras</span>
                            <span id="char-count">0 caracteres</span>
                        </div>
                        <span id="save-status" style="font-size: 0.97em; color: #7F00FF; min-width: 70px; text-align: right;"></span>
                    </footer>
                </section>
            </div>
        </div>
        <script>
        // --- CRUD de Notas ---
        function getNotes() {
            return JSON.parse(localStorage.getItem('enemai_notes')) || [];
        }
        function saveNotes(notes) {
            localStorage.setItem('enemai_notes', JSON.stringify(notes));
        }
        function renderNotesList(filter = '') {
            const notes = getNotes();
            const list = document.getElementById('notes-list');
            list.innerHTML = '';
            const filtered = notes.filter(n => 
                n.title.toLowerCase().includes(filter.toLowerCase()) || 
                n.content.toLowerCase().includes(filter.toLowerCase()) ||
                (n.tags && n.tags.some(tag => tag.toLowerCase().includes(filter.toLowerCase())))
            );
            if(filtered.length === 0) {
                list.innerHTML = '<div style="color:#bdbdbd;text-align:center;padding:2rem;">Nenhuma nota encontrada.</div>';
                return;
            }
            filtered.forEach(note => {
                const div = document.createElement('div');
                div.className = 'note-card';
                div.style.cursor = 'pointer';
                
                // Calcular tempo relativo
                const noteDate = new Date(note.updatedAt);
                const now = new Date();
                const diffTime = Math.abs(now - noteDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                let timeAgo;
                if (diffDays === 1) {
                    timeAgo = "hoje";
                } else if (diffDays <= 7) {
                    timeAgo = `há ${diffDays-1} dia${diffDays-1 > 1 ? 's' : ''}`;
                } else {
                    timeAgo = noteDate.toLocaleDateString('pt-BR');
                }
                
                // Criar HTML para tags
                let tagsHtml = '';
                if (note.tags && note.tags.length > 0) {
                    tagsHtml = '<div style="display: flex; gap: 0.3em; flex-wrap: wrap; margin-top: 0.5em;">';
                    note.tags.slice(0, 3).forEach(tag => { // Limitar a 3 tags
                        tagsHtml += `<span class="note-tag">${tag}</span>`;
                    });
                    if (note.tags.length > 3) {
                        tagsHtml += `<span class="note-tag" style="background: #444;">+${note.tags.length - 3}</span>`;
                    }
                    tagsHtml += '</div>';
                }
                
                div.innerHTML = `
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:1em;">
                        <div style="flex: 1; min-width: 0;">
                            <div class="note-title" style="font-size: 1.1em; margin-bottom: 0.3em;">${note.title || '(Sem título)'}</div>
                            <div class="note-preview" style="font-size: 0.95em; color: #e0e0e0; margin-bottom: 0.5em; line-height: 1.4;">${note.content.replace(/<[^>]+>/g, '').slice(0, 80)}${note.content.length > 80 ? '...' : ''}</div>
                            ${tagsHtml}
                            <div style="font-size:0.8em;color:#bdbdbd;display:flex;align-items:center;gap:0.5em;margin-top:0.5em;">
                                <i class="fas fa-clock"></i>
                                <span>${timeAgo}</span>
                            </div>
                        </div>
                        <div style="display:flex;flex-direction:column;gap:0.4em;flex-shrink:0;">
                            <button class="note-action-btn" data-id="${note.id}" data-action="edit" style="padding: 0.4em 0.8em; font-size: 0.85em;">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                            <button class="note-action-btn" data-id="${note.id}" data-action="delete" style="background:#e74c3c;padding: 0.4em 0.8em; font-size: 0.85em;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                div.querySelector('[data-action="edit"]').onclick = () => loadNote(note.id);
                div.querySelector('[data-action="delete"]').onclick = () => deleteNote(note.id);
                div.onclick = (e) => { 
                    // Só carrega a nota se não clicou em um botão de ação
                    if (!e.target.closest('[data-action]')) {
                        loadNote(note.id);
                    }
                };
                list.appendChild(div);
            });
        }
        function clearEditor() {
            document.getElementById('note-title').value = '';
            document.getElementById('editor-content').innerHTML = '';
            document.getElementById('note-title').dataset.id = '';
        }
        // Função genérica para adicionar tag (exemplo)
        function addTagToCurrentNote(tag) {
            // Supondo que as tags estejam em um array na nota atual
            let id = document.getElementById('note-title').dataset.id;
            let notes = getNotes();
            let note = notes.find(n => n.id === id);
            if (!note) return;
            if (!note.tags) note.tags = [];
            if (!note.tags.includes(tag)) {
                note.tags.push(tag);
                saveNotes(notes);
                renderNotesList(document.getElementById('search-notes').value);
            }
        }
        // Função genérica para exportar nota (exemplo)
        function exportCurrentNote() {
            let id = document.getElementById('note-title').dataset.id;
            let notes = getNotes();
            let note = notes.find(n => n.id === id);
            if (!note) return;
            // Simula exportação (ex: salvar como txt)
            const blob = new Blob([note.title + '\n' + note.content], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = (note.title || 'nota') + '.txt';
            a.click();
        }
        // Função genérica para importar nota (exemplo)
        function importNoteFromFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const id = Date.now().toString();
                let notes = getNotes();
                notes.unshift({id, title: 'Importada', content, updatedAt: Date.now()});
                saveNotes(notes);
                renderNotesList(document.getElementById('search-notes').value);
            };
            reader.readAsText(file);
        }
        // Função para adicionar tag à nota atual
        function addTagToNote(tag) {
            let id = document.getElementById('note-title').dataset.id;
            if (!id) return;
            
            let notes = getNotes();
            let noteIndex = notes.findIndex(n => n.id === id);
            if (noteIndex === -1) return;
            
            if (!notes[noteIndex].tags) {
                notes[noteIndex].tags = [];
            }
            
            if (!notes[noteIndex].tags.includes(tag)) {
                notes[noteIndex].tags.push(tag);
                saveNotes(notes);
                renderNotesList(document.getElementById('search-notes').value);
            }
        }
        
        // Função para remover tag da nota atual
        function removeTagFromNote(tag) {
            let id = document.getElementById('note-title').dataset.id;
            if (!id) return;
            
            let notes = getNotes();
            let noteIndex = notes.findIndex(n => n.id === id);
            if (noteIndex === -1) return;
            
            if (notes[noteIndex].tags) {
                notes[noteIndex].tags = notes[noteIndex].tags.filter(t => t !== tag);
                saveNotes(notes);
                renderNotesList(document.getElementById('search-notes').value);
            }
        }
        
        function saveCurrentNote() {
            const title = document.getElementById('note-title').value.trim();
            const content = document.getElementById('editor-content').innerHTML.trim();
            let id = document.getElementById('note-title').dataset.id;
            let notes = getNotes();
            if(!title && !content) return;
            if(id) {
                // Editar
                notes = notes.map(n => n.id === id ? {...n, title, content, updatedAt: Date.now()} : n);
            } else {
                // Nova
                id = Date.now().toString();
                notes.unshift({id, title, content, updatedAt: Date.now(), tags: []});
            }
            saveNotes(notes);
            document.getElementById('note-title').dataset.id = id;
            renderNotesList(document.getElementById('search-notes').value);
        }
        function loadNote(id) {
            const note = getNotes().find(n => n.id === id);
            if(!note) return;
            document.getElementById('note-title').value = note.title;
            document.getElementById('editor-content').innerHTML = note.content;
            document.getElementById('note-title').dataset.id = note.id;
            renderNoteTags(); // Renderizar tags da nota
        }
        function deleteNote(id) {
            let notes = getNotes();
            notes = notes.filter(n => n.id !== id);
            saveNotes(notes);
            if(document.getElementById('note-title').dataset.id === id) clearEditor();
            renderNotesList(document.getElementById('search-notes').value);
        }
        document.addEventListener('DOMContentLoaded', function() {
            renderNotesList();
            document.getElementById('btn-new-note').onclick = () => { 
                clearEditor(); 
                renderNoteTags();
            };
            document.getElementById('search-notes').oninput = function() { renderNotesList(this.value); };
            document.getElementById('note-title').oninput = saveCurrentNote;
            document.getElementById('editor-content').addEventListener('input', saveCurrentNote);
            
            // Inicializar seção de tags
            renderNoteTags();
        });
        // --- Salvamento automático ---
        let saveTimeout;
        function autoSaveEditor() {
            const editor = document.getElementById('editor-content');
            const status = document.getElementById('save-status');
            status.textContent = 'Salvando...';
            // Salva no localStorage
            localStorage.setItem('enemai_editor_content', editor.innerHTML);
            // Limpa timeout anterior
            if (saveTimeout) clearTimeout(saveTimeout);
            // Após 1.5s sem digitar, mostra 'Salvo!'
            saveTimeout = setTimeout(() => {
                status.textContent = 'Salvo!';
                setTimeout(() => { status.textContent = ''; }, 1200);
            }, 1500);
        }
        document.addEventListener('DOMContentLoaded', function() {
            const editor = document.getElementById('editor-content');
            // Restaura conteúdo salvo
            const saved = localStorage.getItem('enemai_editor_content');
            if (saved) editor.innerHTML = saved;
            editor.addEventListener('input', function() {
                updateEditorCounts();
                autoSaveEditor();
            });
            updateEditorCounts(); // inicializa
        });
        document.addEventListener('DOMContentLoaded', function() {
            const editor = document.getElementById('editor-content');
            const toolbarBtns = Array.from(document.querySelectorAll('.editor-toolbar .toolbar-btn'));
            
            // Adicionar evento para o botão de cabeçalho
            document.getElementById('btn-heading').addEventListener('click', insertHeader);
            
            // Adicionar eventos para o dropdown de exportação
            const exportBtn = document.getElementById('btn-export');
            const exportDropdown = document.getElementById('export-dropdown');
            
            exportBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                exportDropdown.style.display = exportDropdown.style.display === 'block' ? 'none' : 'block';
            });
            
            document.getElementById('btn-export-txt').addEventListener('click', () => {
                exportCurrentNote('txt');
                exportDropdown.style.display = 'none';
            });
            
            document.getElementById('btn-export-md').addEventListener('click', () => {
                exportCurrentNote('md');
                exportDropdown.style.display = 'none';
            });
            
            // Fechar dropdown ao clicar fora
            document.addEventListener('click', function(e) {
                if (!exportBtn.contains(e.target) && !exportDropdown.contains(e.target)) {
                    exportDropdown.style.display = 'none';
                }
            });
            
            // Navegação por setas na toolbar
            toolbarBtns.forEach((btn, idx) => {
                btn.addEventListener('keydown', function(e) {
                    if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        const next = toolbarBtns[(idx + 1) % toolbarBtns.length];
                        next.focus();
                    } else if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        const prev = toolbarBtns[(idx - 1 + toolbarBtns.length) % toolbarBtns.length];
                        prev.focus();
                    } else if (e.key === 'Tab' && !e.shiftKey && idx === toolbarBtns.length - 1) {
                        // Tab no último botão vai para o editor
                        e.preventDefault();
                        editor.focus();
                    } else if ((e.key === 'Enter' || e.key === ' ') && !btn.disabled) {
                        e.preventDefault();
                        btn.click();
                    }
                });
            });
            // Shift+Tab do editor volta para o primeiro botão da toolbar
            editor.addEventListener('keydown', function(e) {
                if (e.key === 'Tab' && e.shiftKey) {
                    e.preventDefault();
                    toolbarBtns[0].focus();
                }
            });
        });
        // Remover todo o JS relacionado à alternância de tema
        </script>
    </main>

    

    

    <!-- CSS e JS essenciais para o editor visual -->
    <style>
    /* ...apenas o CSS do editor, toolbar, sidebar e toast... */
    @keyframes fadein {
        from {opacity: 0; transform: translateY(10px);}
        to {opacity: 1; transform: translateY(0);}
    }
    @keyframes fadeout {
        from {opacity: 1; transform: translateY(0);}
        to {opacity: 0; transform: translateY(10px);}
    }
    
    /* Correção para a área editável */
    .editor-contenteditable {
        overflow-wrap: break-word;
        word-wrap: break-word;
        word-break: break-word;
        white-space: pre-wrap;
        overflow-y: auto;
        max-width: 100%;
        flex: 1;
        min-height: 400px;
        max-height: 600px;
    }
    
    /* Garantir que a área editável não ultrapasse os limites */
    .editor-contenteditable:focus {
        outline: none;
    }
    
    /* Estilo para o placeholder */
    .editor-contenteditable:empty:before {
        content: attr(data-placeholder);
        color: #bdbdbd;
        font-style: italic;
        pointer-events: none;
    }
    
    /* Correção para flexbox */
    .editor-wrapper {
        min-width: 0;
        height: calc(100vh - 100px);
        display: flex;
        flex-direction: column;
        flex: 1;
        overflow: hidden;
    }
    
    /* Correção para imagens e outros elementos */
    .editor-contenteditable img {
        max-width: 100%;
        height: auto;
    }
    
    .editor-contenteditable * {
        max-width: 100%;
    }
    
    /* Garantir altura fixa da área de edição */
    .editor-area {
        display: flex;
        flex-direction: column;
        min-height: 0;
        overflow: hidden;
    }
    
    /* Fixar altura da área editável */
    .editor-content-container {
        flex: 1;
        min-height: 0;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }
    
    .editor-contenteditable {
        width: 100%;
        min-height: 400px;
        max-height: 600px;
        border: none;
        outline: none;
        background: transparent;
        color: var(--cor-texto);
        font-size: 1.18rem;
        font-family: 'Inter', 'Poppins', 'Montserrat', Arial, sans-serif;
        line-height: 1.7;
        resize: none;
        padding: 0;
        margin: 0;
        box-sizing: border-box;
        overflow-wrap: break-word;
        word-wrap: break-word;
        word-break: break-word;
        white-space: pre-wrap;
        overflow-y: auto;
        overflow-x: hidden;
        flex: 1;
        height: 100%;
    }
    
    /* Garantir altura fixa da área de edição */
    .editor-area {
        display: flex;
        flex-direction: column;
        min-height: 0;
        overflow: hidden;
        flex: 1;
        height: 100%;
    }
    
    /* Container para a área editável */
    .editor-content-container {
        flex: 1;
        min-height: 0;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        height: 100%;
    }
    </style>
    <script>
    // updateToolbarState, eventos do editor, atalhos, toast
    // ...apenas o JS essencial para o editor visual...
    </script>
</body>
</html> 